<!DOCTYPE html>
<html lang="ca">
<div th:replace="~{fragments :: head}"></div>

<body>
    <div th:insert="~{fragments :: nav}"></div>

    <!-- Contingut Main -->
    <div class="contingut">
        <main>
           <section>
                <article>


                    <!-- Llista de CANALS
                    <div th:if="${#lists.isEmpty(llistaCanals)}">
                        <p>No hi ha cap canal</p>
                    </div>
                    -->

                    <div th:unless="${#lists.isEmpty(llistaCanals)}">
                        <div class="text-left" th:each="c: ${llistaCanals}">
                            <h3 th:text="${c.titol}"></h3>
                            <p th:text="${c.descripcio}"></p>
                            <!--
                            <div th:if="${#lists.isEmpty(llistaPodcasts)}">
                                
                                <p>Encara no hi ha cap podcast</p>
                                    <form action="eliminaCanal" method="post"
                                        onsubmit="return confirm('Estàs segur que vols eliminar aquest canal?');">
                                        <input type="hidden" name="eliminaIDcanal" th:attr="value=${c.id}" />
                                        <input type="hidden" name="eliminaNomCanal" th:attr="value=${c.titol}" />
                                        <button type="submit" class="btn-entrar efecteButton">
                                            <i class="fas fa-times"></i> Elimina el canal
                                        </button>
                                    </form>
                            </div>
                            -->

                            <!-- Llista de PODCASTS -->
                            <!-- onclick="location.href='podcast/1';" -->
                            <!-- th:attr="onclick=\'location.href=\'podcast/'+${p.id}+'\';" -->
                            <div class='caixa00podcasts' th:if="${llistaPodcasts}">
                                <a class='caixa00 caixa00p'
                                    th:if="${c.id == p.canal.id}"
                                    th:each="p: ${llistaPodcasts}"
                                    th:attr="style='background-image: linear-gradient(#11111100, #111111), url(\'images/'+${p.imatge}+'\');',
                                        href='podcast/'+${p.id}+''">
                                    <div>
                                        <div class='caixa00text' th:text="*{#temporals.format(p.dataPublicacio, 'dd/MM/yyyy')}"></div>
                                        <div class='caixa00titol' th:text="${p.titol}"></div>
                                    </div>
                                </a>
                                <div class='caixa00 caixa00m'>
                                    <div class="caixa00m2">
                                        <button class='caixa00button efecteButton'
                                            data-bs-toggle="modal" data-bs-target="#modalNouPodcast">
                                            &#x271A; Afegir podcast
                                        </button>
                                    </div>
                                    <form action="eliminaCanal" method="post"
                                        class="caixa00m2"
                                        onsubmit="return confirm('Estàs segur que vols eliminar aquest canal?');">
                                        <input type="hidden" name="eliminaIDcanal" th:attr="value=${c.id}" />
                                        <input type="hidden" name="eliminaNomCanal" th:attr="value=${c.titol}" />
                                        <button type="submit" class="caixa00button efecteButton">
                                            &#10006; Eliminar el canal
                                        </button>
                                    </form>
                                </div>
                            </div>

                            <hr/>

                        </div>

                    </div>
                    



                    <!-- Nou CANAL -->
                    <div th:if="${iTitol}">
                        <h1>Has creat el nou canal: <span th:text="${iTitol}"></span></h1>
                        <p th:text="${iDesc}"></p>
                        <p>
                            <form action="perfil">
                                <button class="btn-registre efecteButton">< Torna al perfil</button>
                            </form>
                        </p>
                    </div>

                    <!-- Eliminar CANAL -->
                    <div th:if="${eCanal}">
                        <h1>S'ha eliminat el canal: <span th:text="${eCanal}"></span></h1>
                        <p>
                            <form action="perfil">
                                <button class="btn-registre efecteButton">< Torna al perfil</button>
                            </form>
                        </p>
                    </div>



                    <!-- Variables modUsuari -->
                    <div th:if="${uUsername}">
                        <span th:text="${uUsername}"></span>
                        <br>
                        <span th:text="${uNom}"></span>
                        <span th:text="${uCognom}"></span>
                        <br>
                        <span th:text="${uEmail}"></span>
                    </div>

                </article>
            </section>
        </main>
        

        <aside>
            <h3>PERFIL D'USUARI
                <span class="form-group text-center">
                    <button type="submit" class="btn-mini efecteButton"
                        data-bs-toggle="modal" data-bs-target="#modalModUsuari">
                        <i class='fas fa-user-edit'></i>
                    </button>
                </span>
            </h3>
            <p>
                <span th:text="${session.usuari.username}"></span>
            <p>
            </p>
                <span th:text="${session.usuari.nom}"></span>
                <span th:text="${session.usuari.cognom}"></span>
            <p>
            </p>
                <span th:text="${session.usuari.email}"></span>
            </p>
            <p>
                <!-- Boto Modal -->
                <button type="submit" class="btn-entrar efecteButton"
                    data-bs-toggle="modal" data-bs-target="#modalNouCanal">
                    +CREAR NOU CANAL
                </button>
            </p>
        </aside>

        <div th:replace="~{fragments :: footer}"></div>
    </div>

    <!-- Formulari MODIFICAR USUARI -->
    <div class="modal fade" id="modalModUsuari" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-center">
            <div class="modal-content">
                <div class="title-formulari">
                    <img src="images/logoPodCat00blanc.svg" width="35"/>
                    <h1>PodCat</h1>
                </div>
                <div class="modal-body">
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" alt="Tancar finestra"></button>
                    <div class="formulari-entrar">
                        <h3 class="text-center text-white">Modifica les dades d'usuari</h3>
                        <br>
                        <form action="/modUsuari" method="post">
                            <div class="input-group form-group">
                                <input th:value="${session.usuari.username}"
                                    type="text" class="form-control" placeholder="Nom d'usuari" name="username" required />
                            </div>
                            <div class="input-group form-group">
                                <input th:value="${session.usuari.nom}"
                                    type="text" class="form-control" placeholder="Nom" name="nom" required />
                                <input th:value="${session.usuari.cognom}"
                                    type="text" class="form-control" placeholder="Cognom" name="cognom" required />
                            </div>
                            <div class="input-group form-group">
                                <input th:value="${session.usuari.email}"
                                    type="text" class="form-control" placeholder="Correu electrònic" name="email" required />
                            </div>
                            <div class="form-group text-center">
                                <button type="submit" class="btn-entrar efecteButton">MODIFICA</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulari CREAR NOU CANAL -->
    <div class="modal fade" id="modalNouCanal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-center">
            <div class="modal-content">
                <div class="title-formulari">
                    <img src="images/logoPodCat00blanc.svg" width="35"/>
                    <h1>PodCat</h1>
                </div>
                <div class="modal-body">
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" alt="Tancar finestra"></button>
                    <div class="formulari-entrar">
                        <h3 class="text-center text-white">Crea un nou CANAL</h3>
                        <br>
                        <form action="/nouCanal" method="post">
                            <div class="input-group form-group">
                                <input type="text" class="form-control" placeholder="Títol" name="titol" required/>
                            </div>
                            <div class="input-group form-group">
                                <textarea class="form-control" placeholder="Descripció" name="descripcio" required></textarea>
                            </div>
                            <div class="form-group text-center">
                                <button type="submit" class="btn-entrar efecteButton">CREA</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Formulari NOU PODCAST -->
    <div class="modal fade" id="modalNouPodcast" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-center">
            <div class="modal-content">
                <div class="title-formulari">
                    <img src="images/logoPodCat00blanc.svg" width="35"/>
                    <h1>PodCat</h1>
                </div>
                <div class="modal-body">
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" alt="Tancar finestra"></button>
                    <div class="formulari-entrar">
                        <h3 class="text-center text-white">Afegeix un nou PODCAST</h3>
                        <br>
                        <form action="/nouPodcast" method="post">
                            <div class="input-group form-group">
                                <input type="text" class="form-control" placeholder="Títol" name="titol" required/>
                            </div>
                            <div class="input-group form-group">
                                <textarea class="form-control" placeholder="Descripció" name="descripcio" required></textarea>
                            </div>
                            <div class="form-group text-center">
                                <button type="submit" class="btn-entrar efecteButton">AFEGEIX</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:insert="~{fragments :: scripts}"></div>

</body>
</html>

